---
import { Image } from "astro:assets";
import clsx from "clsx";
import Section from "../../Section.astro";

const features = [
  {
    title: "Interoperability across any format and engine",
    body: "Unity Catalog supports Delta Lake, Apache Iceberg™ via UniForm, Parquet, CSV, JSON, and many other formats. It also implements the Iceberg REST Catalog APIs to interoperate with a broad ecosystem.",
    icon: "icons/Interoperability.svg",
    image: "images/interoperability-cross.webp",
  },
  {
    title: "Openness",
    body: "Unity Catalog is Apache 2.0 licensed, including an OpenAPI specification, server and clients. Adoption of open standards maximizes flexibility and customer choice by ensuring extensive interoperability across various engines, tools, and platforms.",
    icon: "icons/openness.svg",
    image: "images/openness-img.webp",
  },
  {
    title: "Unified governance for data and AI",
    body: "Unity Catalog has built-in governance and security – with strong authentication, secure credential vending, and asset-level access control to protect your data and AI assets with a unified solution. Manage unstructured data, such as images and documents, and Gen AI tools with a single, universal catalog.",
    icon: "icons/unified_governance.svg",
    image: "images/governance-img.svg",
  },
];
---

<Section id="features" padding="lg">
  {
    features.map((feature, i) => (
      <div
        class={clsx("feature-row", {
          ["reverse"]: i % 2 === 1,
        })}
      >
        <div class="feature-left">
          <Image
            src={`/${feature.icon}`}
            alt={feature.title + " icon"}
            class="feature-icon"
            width="56"
            height="56"
            loading="lazy"
          />
          <h3 class="feature-title animation-fadeUp">{feature.title}</h3>
          <p class="feature-body animation-fadeUp">{feature.body}</p>
        </div>
        <div class="feature-right">
          <Image
            src="/images/blur200.svg"
            alt="blur background"
            class="feature-blur-bg"
            width={100}
            height={100}
            loading="lazy"
          />
          <Image
            src={`/${feature.image}`}
            alt={feature.title + " visual"}
            class="feature-image"
            width="528"
            height="528"
            loading="lazy"
          />
        </div>
      </div>
    ))
  }
</Section>
<style>
  .feature-row {
    display: flex;
    align-items: center;
    gap: 3rem;
    margin-bottom: 10rem;
  }
  .feature-left {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 1.5rem;
    overflow: visible;
    text-align: left;
  }
  .feature-title {
    font-size: 2.25rem;
    font-weight: 700;
    color: var(--color-neutral-0);
    line-height: 1.2;
    margin: 0;
  }
  .feature-body {
    color: var(--color-neutral-1000);
    margin: 0;
    font-size: 1.125rem;
  }
  .feature-right {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: flex-end;
    position: relative;
    z-index: 1;
    text-align: right;
  }
  .feature-image {
    width: 100%;
    object-fit: cover;
    display: block;
    position: relative;
    z-index: 2;
  }
  .feature-blur-bg {
    max-width: 62rem;
    right: -6.75vw;
    width: 70vw;
    min-width: 40rem;
    position: absolute;
    inset: auto -5vw -5vw auto;
    pointer-events: none;
    user-select: none;
    z-index: 1;
  }
  @media (min-width: 1101px) {
    .feature-row.reverse {
      flex-direction: row-reverse;
    }
  }
  @media (max-width: 1100px) {
    .feature-row {
      flex-direction: column;
      align-items: flex-start;
      padding-left: 5%;
      padding-right: 5%;
    }
    .feature-left,
    .feature-right {
      align-items: flex-start;
      text-align: left;
      width: 100%;
    }
    .feature-image {
      display: block;
      margin: 2rem 0 0 0;
      width: 100%;
      max-width: 33rem;
      height: auto;
    }
  }
</style>

<script>
  // Apply special styles to the third (last) feature image
  document.addEventListener("DOMContentLoaded", function () {
    const featureImages = document.querySelectorAll(".feature-image");
    const lastFeatureImage = featureImages[
      featureImages.length - 1
    ] as HTMLElement;

    if (lastFeatureImage) {
      lastFeatureImage.style.width = "135%";
      lastFeatureImage.style.minWidth = "36rem";
      lastFeatureImage.style.maxWidth = "45rem";
      lastFeatureImage.style.marginLeft = "-5rem";
      lastFeatureImage.style.marginRight = "-5rem";
      lastFeatureImage.style.display = "block";
    }
  });
</script>
